---

copyright:
  years: 2017, 2018
lastupdated: "2018-12-13"

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:pre: .pre}
{:table: .aria-labeledby="caption"}
{:codeblock: .codeblock}
{:tip: .tip}
{:download: .download}
{:note: .note}
{:important: .important}


# {{site.data.keyword.cloudaccesstrailshort}} events
{: #at_events}

You can view, manage, and audit user-initiated activities made in your {{site.data.keyword.security-advisor_long}} service instance by using the {{site.data.keyword.cloudaccesstrailshort}} service.
{: shortdesc}

For more information about how the service works, see the [{{site.data.keyword.cloudaccesstrailshort}} docs](/docs/services/cloud-activity-tracker/index.html).

</br>

## Viewing administrative events
{: #monitor}

You can view, manage, and audit configuration activity that is made in your {{site.data.keyword.appid_short_notm}} instance by using the {{site.data.keyword.cloudaccesstrailshort}} service.
{: shortdesc}

To monitor administrative activity:

1. Log in to your {{site.data.keyword.Bluemix_notm}} account.
2. From the catalog, provision an instance of the {{site.data.keyword.cloudaccesstrailshort}} service in the same account as your {{site.data.keyword.appid_short_notm}} instance.
3. In the {{site.data.keyword.cloudaccesstrailshort}} dashboard, click the **Manage** tab.
4. From the drop-down list, make the following configurations to search for events that are generated by {{site.data.keyword.appid_short_notm}}.
    * For **View logs**, select **Account logs**.
    * For **Search**, select **target.Management**.
    * For **Filter**, input **appid**.
5. Click **Filter**.

</br>

## List of administrative events
{: #events}

Check out the following table for a list of the events that are sent to {{site.data.keyword.cloudaccesstrailshort}}.

<table>
  <tr>
    <th>Action</th>
    <th>Description</th>
    <th>UI Location</th>
  </tr>
  <tr>
    <td><code>read.recentActivity</code></td>
    <td>View recent activity.</td>
    <td>Can be found in the <strong>Activity Log</strong> box on the <strong>Overview</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.idpConfig</code></td>
    <td>View the identity provider configuration.</td>
    <td>Can be found in the <strong>Identity Providers > Manage</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.idpConfig</code></td>
    <td>Update the identity provider configuration.</td>
    <td>Can be updated in the <strong>Identity Providers > Manage</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.tokensConfig</code></td>
    <td>View the token expiration configuration.</td>
    <td>Can be found in the <strong>Identity Providers > Token Expiration</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.isProfilesActive</code></td>
    <td>View the user profile storage configuration.</td>
    <td>Can be found in the <strong>Activity Log</strong> in the <strong>Overview</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.isProfilesActive</code></td>
    <td>Update your user profile storage configuration.</td>
    <td>Can be found in the <strong>Profiles</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.themeColor</code></td>
    <td>View the theme color of the login widget header.</td>
    <td>Can be found in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.themeColor</code></td>
    <td>Update the theme color of the login widget header.</td>
    <td>Can be Updated in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.media</code></td>
    <td>View the image that is shown in the login widget.</td>
    <td>Can be found in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.media</code></td>
    <td>Update the image that is shown in the login widget.</td>
    <td>Can be updated in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.uiConfiguration</code></td>
    <td>View the login widget UI configuration which includes header color and image.</td>
    <td>Can be found in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.uiLanguages</code></td>
    <td>View a list of supported languages.</td>
    <td>Must be viewed from the API.</td>
  </tr>
  <tr>
    <td><code>update.uiLanguages</code></td>
    <td>Update your supported languages.</td>
    <td>Must be updated through the API.</td>
  </tr>
  <tr>
    <td><code>read.samlMetadata</code></td>
    <td>View the App ID SAML metadata.</td>
    <td>Can be found in the <strong>Identity Providers > SAML 2.0 Federation</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.cloudDirectoryUser</code></td>
    <td>View a Cloud Directory user.</td>
    <td>Can be found in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.cloudDirectoryUser</code></td>
    <td>Update a Cloud Directory User.</td>
    <td>Can be updated in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>delete.cloudDirectoryUser</code></td>
    <td>Delete a Cloud Directory user.</td>
    <td>Can be deleted in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.cloudDirectoryUsers</code></td>
    <td>View a list of your Cloud Directory users.</td>
    <td>Can be found in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.cloudDirectoryUsers</code></td>
    <td>Update your list of Cloud Directory users.</td>
    <td>Can be updated in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>delete.cloudDirectoryUsers</code></td>
    <td>Delete a list of Cloud Directory users.</td>
    <td>Can be deleted in the <strong>Users</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.emailTemplate</code></td>
    <td>View an email template.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Templates</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.emailTemplate</code></td>
    <td>Update an email template.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Templates</strong> tab.</td>
  </tr>
  <tr>
    <td><code>delete.emailTemplate</code></td>
    <td>Delete an email template to reset to the default.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Templates</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.senderDetails</code></td>
    <td>View the sender details.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.senderDetails</code></td>
    <td>Update the sender details</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.resendNotification</code></td>
    <td>Resend user notifications.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.selfForgotPassword</code></td>
    <td>Update the forgot password process.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.forgotPasswordResult</code></td>
    <td>View the forgot password confirmation result.</td>
    <td>Must be done through the API.</td>
  </tr>
  <tr>
    <td><code>update.selfSignUp</code></td>
    <td>Update the sign-up process.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.signUpResult</code></td>
    <td>View the sign-up result confirmation.</td>
    <td>Must be done through the API.</td>
  </tr>
  <tr>
    <td><code>read.action_url</code></td>
    <td>View the custom URL that is called when an action is performed.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Custom Landing Pages</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.action_url</code></td>
    <td>Update the custom URL that is called when an action is performed.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.changePassword</code></td>
    <td>Change the Cloud Directory user password.</td>
    <td>Can be found in the <strong>Identity Providers > Cloud Directory > Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.loginWidgetConfig</code></td>
    <td>View your login widget configuration.</td>
    <td>Can be found in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.loginWidgetConfig</code></td>
    <td>Update your login widget configuration.</td>
    <td>Can be updated in the <strong>Login Customization</strong> tab.</td>
  </tr>
  <tr>
    <td><code>read.captureRuntimeActivity</code></td>
    <td>View runtime activity toggle.</td>
    <td>Can be viewed in the <strong>Identity Providers > Manage > Authentication Settings</strong> tab.</td>
  </tr>
  <tr>
    <td><code>update.captureRuntimeActivity</code></td>
    <td>Toggle runtime activity monitoring.</td>
    <td>Can be updated in the <strong>Identity Providers > Manage > Authentication Settings</strong> tab.</td>
  </tr>
</table>

</br>
</br>

## Viewing runtime events
{: #monitor-runtime}

You can audit runtime activity such as logins, password resets, and authentications by using the {{site.data.keyword.cloudaccesstrailshort}} service.
{: shortdesc}


<ul>
<li>This feature is available only for instances on graduated tier payment plan that were created after March 15, 2018.</li>
<li>The reported events are per account, not per resource group.</li>
<li>There are limitations on the data rate and retention period of the collected runtime events. Increasing the limits might require an upgrade of the {{site.data.keyword.cloudaccesstrailshort}} service. For more information about the service limits, see the [{{site.data.keyword.cloudaccesstrailshort}} docs](/docs/services/cloud-activity-tracker/compliance.html).</li>
<li>Using this feature incurs an extra charge. For more information on graduated tier pricing, see the [{{site.data.keyword.Bluemix_notm}} pricing docs](/docs/billing-usage/how_charged.html).</li></ul>
{: important}

</br>

To monitor runtime activity:

1. Log in to your {{site.data.keyword.Bluemix_notm}} account.
2. From the catalog, provision an instance of the {{site.data.keyword.cloudaccesstrailshort}} service in the same account as your {{site.data.keyword.appid_short_notm}} instance.
3. In the {{site.data.keyword.cloudaccesstrailshort}} dashboard, click the **Manage** tab, then click the **Authentication Settings** tab in the main window.
4. In the **Runtime Activity** panel, toggle the switch to enable tracking of runtime activities for the current instance. A message displays that notifies you that the feature is enabled.
</br>

## Analyzing runtime events
{: #events}

A user that generates a runtime event is identified as a GUID rather than by name or email due to PII requirements. As the owner of the account, you can gather that information from the GUID and track events made by a specific user.

**Extracting PII information from the GUID**

The following scenario works only for Cloud Directory users. If the user is defined by an external IdP such as Google or Facebook, only that IdP can interpret the GUID.
{: note}

An event in the {{site.data.keyword.cloudaccesstrailshort}} console contains the following fields.

<table>
  <tr>
    <th>Field</th>
    <th>Value</th>
    <th>Description</th>
  </tr>
  <tr>
    <td>initiator.id</td>
    <td>cb967e0d-43c1-454a-968d-0efa24766846</td>
    <td>Contains the tenant ID.</td>
  </tr>
  <tr>
    <td>target.name</td>
    <td>cloud_directory:34e1ea6d-cc02-4941-9462-7e9c5a40b360</td>
    <td>Contains the user profile ID.</td>
  </tr>
</table>


1. In the **Credentials** tab of the {{site.data.keyword.appid_short_notm}} dashboard, copy and save the information in the `apiKey` and `tenantID` fields. The tenant ID should match the ID of the event. If no credentials exist, create a set.

2. Obtain a **yam** token for the `apiKey` by inserting the key into the following command:

  ```
  curl -k -X POST \
      --header "Content-Type: application/x-www-form-urlencoded" \
      --header "Accept: application/json" \
      --data-urlencode "grant_type=urn:ibm:params:oauth:grant-type:apikey" \
      --data-urlencode "apikey=THE_API_KEY" \
      "https://iam.cloud.ibm.com/identity/token"
  ```
  {: codeblock}

3. Copy the **yam** token from the **access_token** field in the response.

4. Select a region.

5. Insert the `yam` token, the tenant ID, and the user profile ID, into the following command to obtain the user information.

  ```
  curl -X GET --header 'Accept: application/json' --header 'Authorization: Bearer THE_IAM_TOKEN' \
  'https://appid-management.THE_REGION.bluemix.net/management/v4/THE_TENANT_ID/cloud_directory/Users/THE_USER_PROFILE_ID'
  ```
  {: codeblock}

You can also run this command in the management service swagger. Your output would look similar to the following:

```
  {
  "displayName": "test test",
  "active": true,
  "userName": "test0001",
  "mfaContext": {},
  "emails": [
    {
      "value": "mytest@yahoo.com",
      "primary": true
    }
  ],
  "meta": {
    "lastLogin": "2018-12-10T16:05:36.665Z",
    "created": "2018-08-21T08:55:50.643Z",
    "location": "/v1/cb967e0d-43c1-454a-968d-0efa24766846/Users/34e1ea6d-cc02-4941-9462-7e9c5a40b360",
    "lastModified": "2018-12-10T16:05:36.675Z",
    "resourceType": "User"
  },
  "schemas": [
    "urn:ietf:params:scim:schemas:core:2.0:User"
  ],
  "name": {
    "givenName": "test",
    "familyName": "test",
    "formatted": "test test"
  },
  "id": "34e1ea6d-cc02-4941-9462-7e9c5a40b360"
}
```
{: screen}


</br>


**Finding user related events**

You can track the events of specific Cloud Directory users in {{site.data.keyword.cloudaccesstrailshort}} by using their email. Before you can begin tracking, the email must be mapped to a Cloud Directory GUID.


1. Obtain a `yam` token, a tenant ID and a region as described in the previous section.
2. Insert the `yam` token, the tenant ID, and the email into the following command to obtain the user information.

  ```
  curl -X GET --header 'Accept: application/json' --header 'Authorization: Bearer THE_IAM_TOKEN' 'https://appid-management.THE_REGION.bluemix.net/management/v4/THE_TENANT_ID/users?email=THE_EMAIL_ADDRESS'
  ```
  {: codeblock}

  The email address should be escaped, e.g. myTest%40yahoo.com instead of myTest@yahoo.com.
  {: note}

  Alternatively, you can use the Management APIs. Your output would look similar to the following:

  ```
  {
    "users": [
      {
        "idp": "cloud_directory",
        "id": "1e123399-3499-4a5c-b5a9-93843a91dc80"
      },
      {
        "idp": "cloud_directory",
        "id": "2a7abbe5-0fce-402e-9ddf-265246b415c8"
      }
    ]
  }
  ```
  {: screen}

3. Search for a **cloud_directory:id** value in the **target.name** field in the {{site.data.keyword.cloudaccesstrailshort}} console.

</br>
</br>


## List of runtime events
{: #events}

Check out the following table for a list of the runtime events that are sent to {{site.data.keyword.cloudaccesstrailshort}}.

<table>
  <tr>
    <th><code>Description</code></th>
    <th><code>action</code></th>
    <th><code>outcome</code></th>
    <th><code><reason. reasonCode</code></th>
    <th><code>target.id</code></th>
    <th><code>target.name</code></th>
    <th><code>target.typeURI</code></th>
  </tr>
  <tr>
    <td>Cloud Directory authentication success</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>cloud_directory:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory authentication failure</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>failure</code></td>
    <td><code>401</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>cloud_directory:unknown</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>Facebook authentication success</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>facebook:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td><code>Facebook authentication failure</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>failure</code></td>
    <td><code>401</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>facebook:unknown</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td><code>Google authentication success</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>google:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>Google authentication failure</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>failure</code></td>
    <td><code>401</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>google:unknown</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>SAML authentication success</td>
    <td><code>appid.user.authentication</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>SAML:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>SAML authentication failure</code></td>
    <td><code>appid.user.authentication</code></td>
    <td><code>failure</code></td>
    <td><code>401</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>SAML:unknown</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory signup</td>
    <td><code>appid.cloud_dir.user.create</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>cloud_directory:GUID</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory signup failure</td>
    <td><code>appid.cloud_dir.user.create</code></td>
    <td><code>failure</code></td>
    <td><code>400</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>cloud_directory:unknown</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory signup confirmation</td>
    <td><code>appid.cloud_dir.user.allow</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>cloud_directory:GUID</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory signup confirmation failure</td>
    <td><code>appid.cloud_dir.user.allow</code></td>
    <td><code>failure</code></td>
    <td><code>400</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>cloud_directory:unknown</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory change or reset password</td>
    <td><code>appid.cloud_dir.user.credentials.update</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>cloud_directory:GUID</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Cloud Directory change or reset password failure</td>
    <td><code>appid.cloud_dir.user.credentials.update</code></td>
    <td><code>failure</code></td>
    <td><code>400</code></td>
    <td><code>crn:unknown</code></td>
    <td><code>cloud_directory:unknown</code></td>
    <td><code>appid/cloud_dir/user</code></td>
  </tr>
  <tr>
    <td>Revoke user tokens</td>
    <td><code>appid.user.tokens.revoke</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>[idp]:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>Revoke user tokens failure</td>
    <td><code>appid.user.tokens.revoke</code></td>
    <td><code>failure</code></td>
    <td><code>400</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>[idp]:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
  <tr>
    <td>User logout</td>
    <td><code>appid.user.logout</code></td>
    <td><code>success</code></td>
    <td><code>200</code></td>
    <td><code>appid user CRN</code></td>
    <td><code>[idp]:GUID</code></td>
    <td><code>appid/user</code></td>
  </tr>
</table>

</br>
Additional field names that appear in the Activity Tracker console have these values:
<table>
  <tr>
    <th>Field</th>
    <th>Value</th>
  </tr>
  <tr>
    <td><code>eventTime</code></td>
    <td>Timestamp of the event</td>
  </tr>
    <td><code>requestData</code></td>
    <td>The instance's client id</td>
  <tr>
    <td><code>initiator.id</code></td>
    <td>The account id</td>
  </tr>
  <tr>
    <td><code>initiator.typeURI</code></td>
    <td>service/security/account/user</td>
  </tr>
</table>

</br>
</br>
